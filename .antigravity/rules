# Antigravity 交互与开发规则

## 核心规则
- **语言偏好**：始终使用**中文**进行回复和沟通。
- **回复风格**：作为强大的 AI 编程助手，保持专业、高效且友好的协作态度。

## 最佳实践与架构准则

### 1. 代码模块化 (Modularity)
- 避免创建庞大的单体文件（如超过 1000 行的文件）。
- 按照职责分离原则（Separation of Concerns），将功能拆分为独立模块（如 `api_tags.py`, `api_security.py` 等）。
- 核心逻辑应放在 `core/` 目录下，API 层仅负责路由和参数校验。

### 2. 健壮的错误处理 (Resilient Error Handling)
- 始终使用 `try...except` 捕获可能的异常，并记录详细的错误日志。
- 对于 API 接口，确保即使在部分数据缺失的情况下也能返回有意义的 fallback 数据（降级处理），而不是直接报错。
- 避免使用裸 `except:`，应捕获具体的异常类型。

### 3. 类型安全与文档 (Type Safety & Docs)
- 强力推荐使用 Python 类型注解（Type Hints）。
- 为复杂的函数和类添加清晰的 Docstrings。
- 重要变更需同步更新 `README.md` 或相关技术文档。

### 4. 性能与安全 (Performance & Security)
- 定期进行代码审计，识别性能瓶颈。
- 敏感信息（如 API Keys）严禁硬编码在源码中，必须通过系统环境变量或 `.env` 文件加载。
- 数据库操作优先使用参数化查询，防止 SQL 注入。

### 5. 持续测试与验证 (Validation & Testing)
- **多端全覆盖**：每次代码变更（重构、漏洞修复或新功能）后，必须同时通过 **CLI** 命令和 **Web 界面**进行双重验证。
- **浏览器实测 (Chrome)**：Web 端测试应当优先使用 **Chrome 浏览器**执行。重点验证前端路由、组件交互、图表渲染（如 Treemap, Sankey）以及整体 UI/UX 的一致性，确保“想要的效果”能在真实浏览器环境下还原。
- **API 逻辑闭环**：结合 `curl` 工具验证 API 返回值的准确度，确保后端重构不会导致业务逻辑的中断。
